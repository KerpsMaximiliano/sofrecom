<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-xs-12">
        <h2>{{'ADMIN.module.title' | translate }}</h2>
        <ol class="breadcrumb">
            <li>
                <a [routerLink]="['/']">{{'HOME.TITLE' | translate }}</a>
            </li>
            <li>
                <a>{{'ADMIN.SHORT_TITLE' | translate }}</a>
            </li>
            <li>
                <a [routerLink]="['../../']">{{'ADMIN.module.title' | translate }}</a>
            </li>
            <li class="active">
                <strong>{{'ACTIONS.EDIT' | translate }}</strong>
            </li>
        </ol>
    </div>
</div>

<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-xs-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>{{'ADMIN.module.edit' | translate }}</h5>
                    <div class="ibox-tools" >
                        <a [routerLink]="['../../']"><i class="fa fa-close"></i></a>
                    </div>
                </div>
                <div class="ibox-content">
                    <form class="form-horizontal" #formRef="ngForm" (ngSubmit)="onSubmit(formRef)" *ngIf="module != null">

                        <!-- Code -->
                        <div class="form-group"><label class="col-xs-2 control-label">Código</label>
                            <div class="col-xs-4">
                              <input type="text"  
                                  name="code"
                                  class="form-control" 
                                  [(ngModel)]="module.code"
                                  #descripRef="ngModel"
                                  required
                                  maxlength="5"> 
                              <div class="help-block m-b-none text-danger" [style.visibility]="(!formRef._submitted || !descripRef?.errors?.required) ? 'hidden' : 'visible' ">Description is required</div>

                            </div>
                        </div>

                        <!--Description-->
                        <div class="form-group"><label class="col-xs-2 control-label">Descripción</label>
                            <div class="col-xs-10">
                              <input type="text"  
                                  name="description"
                                  class="form-control" 
                                  [(ngModel)]="module.description"
                                  #descripRef="ngModel"
                                  required> 
                              <div class="help-block m-b-none text-danger" [style.visibility]="(!formRef._submitted || !descripRef?.errors?.required) ? 'hidden' : 'visible' ">Description is required</div>

                            </div>
                        </div>

                        <!--CHECK ACTIVE-->
                        <div class="form-group" *ngIf="module">
                            <div class="col-xs-12">
                                 <icheck  [(checked)]="module.active">
                                     <label class="col-xs-2 control-label icheck-label">Activo</label> 
                                 </icheck>
                            </div>
                        </div>

                        <div>&nbsp;</div>

                        <!--ACEPTAR-->
                        <div class="form-group">
                            <div class="col-xs-offset-2 col-xs-2">
                                <button class="btn btn-sm btn-primary m-t-n-xs" type="submit"><strong>Aceptar</strong></button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

     <div class="row">

    <!--MODULES-->
    <div class="col-lg-6">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <i class="fa fa-info-circle"></i> Funcionalides
                <a class="pull-right" [hidden]="module.functionalities && module.functionalities.length == allFunctionalities.length" (click)="addFunctionality()"><i class="fa fa-plus icon-white"></i></a>
            </div>
            <div class="panel-body">
                <div class="scroll">
                    <div class="dd">
                        <ol class="dd-list">
                            <li *ngFor="let f of module.functionalities" class="dd-item">
                                <div class="dd-handle">
                                    {{f.description}}
                                    <a class="pull-right" (click)="openConfirmModal(f.id)"><i class="check-link fa fa-times icon-danger margin-left-s"></i></a>
                                </div>
                            </li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <ng2-modal [config]="functionalityModalConfig"  #functionalityModal (accept)="assignFunctionalities()">

        <h4 class="margin-bottom-m">Seleccione las funcionalidades a ser asginadas al modulo</h4>
        
        <div class="row">
            <div class="col-xs-12">
                <div class="scroll form-group">
                    <div *ngFor="let f of functsToAdd; let i = index"  style="margin-top:10px;">
                        <icheck  [checkAtLeft]="checkAtLeft" [(checked)]="f.included" >
                            <label style="padding-left:20px;">{{f.text}}</label> 
                        </icheck>
                    </div>
                </div>
            </div>
        </div>
    </ng2-modal>
</div>

<ng2-modal [config]="confirmModalConfig"  #confirmModal (accept)="unAssignFunctionality(functionalityId)">
    ¿Esta seguro que desea eliminar la funcionalidad?
</ng2-modal>
