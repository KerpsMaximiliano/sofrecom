<div class="table-responsive billing-table">
    <table class="table table-striped dataTable table-bordered" role="grid">
        <thead>
            <tr>
                <th class="first-column"></th>
                <th class="text-center" *ngFor="let month of months">{{ month.display }}</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let total of totals">
                <td class="first-column text-ellipsis">Total Facturaci√≥n {{ total.currencyName }}</td>
                <td *ngFor="let month of total.monthValues"><label class="label" class="label label-primary">{{ month.value | amountFormat }}</label></td>
            </tr>
            <tr>
                <td class="first-column text-ellipsis">Cantidad recursos facturados</td>
                <td *ngFor="let month of months"><label class="label label-primary">{{ month.resourceQuantity }}</label></td>
            </tr>
            <tr>
                <td [attr.colspan]="months.length+1" class="hitos-title">Hitos</td>
            </tr>
            <tr *ngFor="let hito of hitos">
                <td class="first-column text-word-break">
                    {{ hito.description }}
                    <i class="fa fa-2x fa-trash pointer" (click)="delete(hito)" *ngIf="canDeleteHito(hito)"></i>
                </td>
                
                <td *ngFor="let value of hito.values">
                    <input *ngIf="value.value > 0" 
                        type="number" 
                        class="form-control input-sm" 
                        [ngClass]="resolveHitoLabel(value)" 
                        decimalFormat
                        min="0" 
                        (blur)="updateHito(hito)"
                        [(ngModel)]="value.value"
                        [disabled]="!isEnabled(value)">
                </td>
            </tr>
        </tbody>
    </table>       
</div>

<div class="detail-actions m-t-sm">
    <button *ngIf="canCreateHito()" (click)="openHitoModal()" type="button" class="btn btn-success btn-sm">
        {{ 'billing.project.detail.milestone.create' | translate }}  <i class="fa fa-plus"></i>
    </button> 
    <button class="btn btn-primary" type="button">Guardar <i class="fa fa-save"></i></button>
</div>

<ng2-modal [config]="newHitoModalConfig" #newHitoModal (accept)="createHito()">

    <div class="form-group">
        <label class="control-label">Proyectos</label>
        <ng-select [items]="projects" bindLabel="text" bindValue="id" [(ngModel)]="hito.projectId"></ng-select>
    </div>

    <div class="row">
        <div class="col-sm-12">
            <div class="form-group">
                <label class="control-label">{{ 'billing.project.detail.milestone.name' | translate }}</label>
                <input type="text" class="form-control" [(ngModel)]="hito.name">
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-6">
            <div class="form-group">
                <label class="control-label">{{ 'billing.solfac.currency' | translate }}</label>
                <ng-select [items]="currencies" bindLabel="text" bindValue="id" [(ngModel)]="hito.moneyId"></ng-select>
            </div>
        </div>
        <div class="col-sm-6">
            <label class="control-label">{{ 'billing.project.detail.milestone.amount' | translate }}</label>
            <input type="number" decimalFormat class="form-control" [(ngModel)]="hito.ammount">
        </div>
    </div>

    <div class="row">
        <div class="col-sm-6">
            <div class="form-group">
                <label class="control-label">{{'billing.project.detail.milestone.startDate' | translate }}</label>
                <date-picker [(date)]="hito.startDate"></date-picker>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-3">
            <div class="form-group">
                <label class="control-label">{{ 'billing.project.detail.milestone.month' | translate }}</label>
                <input type="number" min="1" max="12" class="form-control" [(ngModel)]="hito.month">
            </div>
        </div>
    </div>

</ng2-modal> 