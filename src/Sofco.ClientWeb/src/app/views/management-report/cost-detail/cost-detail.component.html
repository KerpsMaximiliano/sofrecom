<div class="table-responsive billing-table">
    <table class="table dataTable" role="grid">
        <thead>
            <tr>
                <th class="static first-column" scope="col">Meses</th>
                <th class="text-center headcol" *ngFor="let month of months; first as isFirst"
                    [ngClass]="{'first-col': isFirst}">{{ month.display }}</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th class="static first-column" scope="col">Total Costos</th>
                <td *ngFor="let month of months; let i = index; first as isFirst" [ngClass]="{'first-col': isFirst}">
                    <label class="label label-total">
                        {{ calculateTotalCosts(i) | amountFormat }}
                    </label>
                </td>
            </tr>
            <tr>
                <th class="static first-column" scope="col">Cantidad Recursos costeados</th>
                <td *ngFor="let month of months; let i = index; first as isFirst" [ngClass]="{'first-col': isFirst}">
                    <label class="label label-cant-resources">
                        {{ calculateAssignedEmployees(i) }}
                    </label>
                </td>
            </tr>
            <tr>
                <th class="static first-column text-ellipsis" scope="col">EVALPROP</th>
                <td *ngFor="let month of months; first as isFirst" [ngClass]="{'first-col': isFirst}">
                    <label class="label label-success" [ngClass]="canEditCdg() ? 'pointer' : ''"
                        (click)="openEditEvalProp(month)">{{ month.valueEvalProp  | amountFormat }}</label>
                </td>
            </tr>
            <tr class="active" *ngFor="let employee of employees">
                <th class="static first-column" scope="col">{{ employee.display }}</th>
                <td *ngFor="let monthCost of employee.monthsCost; let i = index; first as isFirst"
                    [ngClass]="{'first-col': isFirst}">
                    <label class="label" (click)="openEditItemModal(monthCost, employee, i)"
                        [ngClass]="AccessEmployeeClass(monthCost)">
                        {{ monthCost.value | amountFormat }}
                    </label>
                </td>
            </tr>
            <tr class="warning" *ngFor="let profile of costProfiles">
                <th class="static first-column" scope="col">{{ profile.display }}</th>
                <td *ngFor="let monthCost of profile.monthsCost; let i = index; first as isFirst"
                    [ngClass]="{'first-col': isFirst}">
                    <label class="label" (click)="openEditItemModal(monthCost, profile, i)"
                        [ngClass]="resourcesClass(monthCost, profile)">
                        {{ monthCost.value | amountFormat }}
                    </label>
                </td>
            </tr>
            <tr>
                <th class="static first-column" scope="col">Total Sueldo</th>
                <td *ngFor="let month of months; let i = index; first as isFirst" [ngClass]="{'first-col': isFirst}">
                    <label class="label label-salary">
                        {{ calculateAllSalary(i) | amountFormat }}
                    </label>
                </td>
            </tr>
            <tr>
                <th class="static first-column" scope="col">Prepaga</th>
                <td *ngFor="let month of months; let i = index; first as isFirst" [ngClass]="{'first-col': isFirst}">
                    <label class="label label-salary">
                        {{ calculateAllPrepaid(i) | amountFormat }}
                    </label>
                </td>
            </tr>
            <tr>
                <th class="static first-column" scope="col">Cargas (0.51 del sueldo)</th>
                <td *ngFor="let month of months; let i = index; first as isFirst" [ngClass]="{'first-col': isFirst}">
                    <label class="label label-load">
                        {{ calculateLoads(i) | amountFormat }}
                    </label>
                </td>
            </tr>
            <tr *ngFor="let item of fundedResources; let i = index">
                <th class="static first-column" scope="col">
                    <p>
                        {{ item.display }}
                    </p>
                    <i class="fa fa-2x fa-trash pointer" (click)="deleteResources(item, i)"
                        *ngIf="canDeleteResources(item)"></i>
                </th>
                <td *ngFor="let monthCost of item.monthsCost; let i = index; first as isFirst"
                    [ngClass]="{'first-col': isFirst}">
                    <label class="label" (click)="openEditItemModal(monthCost, item, i)"
                        [ngClass]="resourcesClass(monthCost, item)">
                        {{ monthCost.value | amountFormat }}
                    </label>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<br>
<div class="row" *ngIf="otherResources.length > 0">
    <div class="col-sm-5">
        <div class="form-group">
            <ng-select [items]="otherResources" bindLabel="typeName" [(ngModel)]="otherSelected"
                (change)="otherResourceChange()">
            </ng-select>
        </div>
    </div>
    <div class="col-sm-5" *ngIf="showUsers">
        <div class="form-group">
            <ng-select [items]="users" bindLabel="text" [(ngModel)]="userSelected">
            </ng-select>
        </div>
    </div>
    <div class="col-sm-5" *ngIf="showProfiles">
        <div class="form-group">
            <ng-select [items]="profiles" bindLabel="text" [(ngModel)]="profileSelected">
            </ng-select>
        </div>
    </div>
    <div class="col-md-2" *ngIf="menuService.hasFunctionality('MANRE', 'EDIT-COST-DETAIL')">
        <button class="btn btn-success btn-md" type="button" (click)="addOtherCost()">
            Agregar
            <i class="fa fa-plus"></i></button>
    </div>

</div>

<!-- <div class="detail-actions m-t-sm text-center" *ngIf="menuService.hasFunctionality('MANRE', 'EDIT-COST-DETAIL')">
    <button class="btn btn-primary cursor-pointer" type="button" (click)="save()">Guardar <i
            class="fa fa-save"></i></button>
</div> -->

<ng2-modal [config]="editItemModalConfig" #editItemModal (accept)="EditItem()" (close)="EditItemOnClose()"
    [isSaveEnabled]="editItemMonto.valid">

    <div class="row">
        <div class="col-sm-12">
            <div class="form-group">
                <fieldset>
                    <label class="control-label" for="readOnlyInput">Mes</label>
                    <input class="form-control" id="readOnlyInput" type="text" placeholder="{{ monthSelected.display }}"
                        readonly="">
                </fieldset>
            </div>
            <div class="form-group" *ngIf="modalEmployee">
                <label class="control-label">Monto final</label>
                <div class="input-group">
                    <span class="input-group-addon">$</span>
                    <input class="form-control" id="readOnlyInput" type="text"
                        placeholder="{{ editItemMonto.value + editItemMonto.value * editItemAdjustment.value / 100}}"
                        readonly="">
                </div>
            </div>
            <div class="form-group" *ngIf="modalPercentage || modalProfile || modalEmployee">
                <label class="control-label">Monto</label>
                <div class="input-group">
                    <span class="input-group-addon" *ngIf="!modalPercentage">$</span>
                    <input type="number" decimalFormat class="form-control" [formControl]="editItemMonto">
                    <span class="input-group-addon" *ngIf="modalPercentage">%</span>
                </div>
            </div>
            <div class="form-group" *ngIf="modalEmployee">
                <label class="control-label">% Ajuste x Recurso</label>
                <div class="input-group">
                    <input type="number" decimalFormat class="form-control" [formControl]="editItemAdjustment">
                    <span class="input-group-addon">%</span>
                </div>
            </div>

            <div *ngIf="modalOther">
                <div class="row border-bottom m-b-sm">
                    <div class="col-sm-4">
                        <h4>Gastos</h4>
                    </div>
                    <div class="col-sm-4">
                        <h4>Descripci√≥n</h4>
                    </div>
                    <div class="col-sm-4">
                        <h4>Monto</h4>
                    </div>
                </div>

                <div class="row m-t-xs" *ngFor="let other of othersByMonth; let i = index">
                    <div class="col-sm-4">
                        {{ other.typeName }}
                    </div>
                    <div class="col-sm-4">
                        <input type="text" class="form-control input-xs" [(ngModel)]="other.description"
                            maxlength="200">
                    </div>
                    <div class="col-sm-4">
                        <input type="number" decimalFormat class="form-control input-xs" [digitLimit]="8"
                            [(ngModel)]="other.value" max="99999999" min="0">
                    </div>
                </div>
                <button class="btn btn-success btn-sm m-t-xs" (click)="addOtherByMonth()" type="button">
                    Agregar
                    <i class="fa fa-plus"></i>
                </button>
            </div>

        </div>
    </div>

    <div class="alert alert-gaps-warning" *ngIf="modalPercentage">
        <i class="fa fa-warning"></i>
        El valor ingresado modificara el monto de todos los recursos en ese mes
    </div>
</ng2-modal>