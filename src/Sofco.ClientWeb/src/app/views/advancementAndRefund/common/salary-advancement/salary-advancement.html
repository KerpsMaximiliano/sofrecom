<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-12">
        <h2> Devoluciones </h2>
        <ol class="breadcrumb">
            <li>
                <a [routerLink]="['/']">{{'HOME.TITLE' | translate }}</a>
            </li>
            <li>
                {{'advancement.navigationTitle' | translate }}
            </li>
            <li class="active">
                <strong> Devoluciones </strong>
            </li>
        </ol>
    </div>
</div>

<div class="wrapper wrapper-content animated fadeInRight">
    <div class="ibox">
        <div class="ibox-content">
            <table class="table table-striped dataTable" role="grid" id="salary-advancement">
                <thead>
                    <tr>
                        <th>Solicitante</th>
                        <th>Total adelantos</th>
                        <th>Total pendiente</th>
                        <th>Total descontado</th>
                    </tr>
                </thead>
                <tbody> 
                    <tr *ngFor="let item of model" (click)="selectItem(item)" class="pointer">
                        <td>{{ item.userName }}</td>
                        <td>{{ item.totalAmount | amountFormat }}</td>
                        <td>{{ item.pendingAmount | amountFormat }}</td>
                        <td>{{ item.discountedAmount | amountFormat }}</td>
                    </tr>
                </tbody>
            </table>   
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-4" *ngFor="let item of advancementSelecteds">
            <div class="ibox">
                <div class="ibox-title">
                    <h4 class="pull-left">Devoluciones Adelanto #{{ item.advancementId }}</h4>
            
                    <div class="ibox-tools" >
                        <button class="btn btn-primary btn-xs" (click)="openModal(item)"> {{ 'ACTIONS.ADD' | translate }} <i class="fa fa-plus"></i></button>
                    </div>
                </div>
                <div class="ibox-content">
                    <p><strong>Total adelanto:</strong>  ${{ item.total | amountFormat }}</p>
                    <p><strong>Forma devolucion:</strong>  {{ item.returnForm }}</p>

                    <div class="alert alert-gaps-info m-t-sm" style="padding: 5px" *ngIf="!item.discounts || item.discounts.length == 0">
                        <i class="fa fa-info"></i>
                        {{ 'noInfoAvailable' | translate }}
                    </div>

                    <table class="table table-striped dataTable" *ngIf="item.discounts && item.discounts.length > 0">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Monto</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody> 
                            <tr *ngFor="let discount of item.discounts" class="pointer">
                                <td>{{ discount.date | date: 'dd/MM/yyyy' }}</td>
                                <td>{{ discount.amount | amountFormat }}</td>
                                <td><button class="btn btn-danger btn-xs" (click)="delete(discount)"><i class="fa fa-trash"></i></button></td>
                            </tr>
                        </tbody>
                    </table>   
                </div>
            </div>
        </div>
    </div>
</div>

<ng2-modal [config]="addModalConfig" #addModal (accept)="save()">
     
    <div class="form-group">
        <label class="control-label">Fecha devolución</label>
        <date-picker [(date)]="date"></date-picker>
    </div>

    <div class="form-group">
        <label class="control-label">Monto devolución</label>
        <input type="number" decimalFormat class="form-control" [(ngModel)]="amount">
    </div>
 
</ng2-modal> 